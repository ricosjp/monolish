<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>monolish: GPU Examples</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">monolish
   &#160;<span id="projectnumber">0.16.3</span>
   </div>
   <div id="projectbrief">MONOlithic LInear equation Solvers for Highly-parallel architecture</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GPU Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_sample_doc_gpu"></a> </p>
<h1><a class="anchor" id="autotoc_md106"></a>
Introduction</h1>
<p>The following four classes have the <code>computable</code> attribute:</p><ul>
<li><a class="el" href="../../d7/d15/classmonolish_1_1vector.html" title="vector class">monolish::vector</a></li>
<li><a class="el" href="../../d2/d67/classmonolish_1_1view1_d.html" title="1D view class">monolish::view1D</a></li>
<li><a class="el" href="../../db/da5/classmonolish_1_1matrix_1_1_c_r_s.html" title="Compressed Row Storage (CRS) format Matrix.">monolish::matrix::CRS</a></li>
<li><a class="el" href="../../db/d46/classmonolish_1_1matrix_1_1_dense.html" title="Dense format Matrix.">monolish::matrix::Dense</a></li>
</ul>
<p>These classes support computing on the GPU and have five functions for GPU programming.</p><ul>
<li><a class="el" href="../../d7/d15/classmonolish_1_1vector.html#a09760a7769785af653334658bcefd0fc">send()</a></li>
<li><a class="el" href="../../d7/d15/classmonolish_1_1vector.html#a3c099868f9b37f98d7433aa2d34f140b">recv()</a></li>
<li><a class="el" href="../../d7/d15/classmonolish_1_1vector.html#af3b0bc470aef7f901cb118d88b1ef679">device_free()</a></li>
<li><a class="el" href="../../d7/d15/classmonolish_1_1vector.html#ad83e7621982a43736f19608ccedb2ccd">get_device_mem_stat()</a></li>
</ul>
<p>When <code>libmonolish_cpu.so</code> is linked, <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">send()</a> and <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9" title="recv. and free data from GPU">recv()</a> do nothing, the CPU and GPU code can be shared.</p>
<p>When <code>libmonolish_gpu.so</code> is linked, these functions enable data communication with the GPU.</p>
<p>Each class is mapped to GPU memory by using the <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">send()</a> function. The class to which the data is transferred to the GPU behaves differently, and it becomes impossible to perform operations on the elements of vectors and matrices.</p>
<p>Whether the data has been transferred to the GPU can be obtained by the get_device_mem_stat() function.</p>
<p>The data mapped to the GPU is released from the GPU by <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9" title="recv. and free data from GPU">recv()</a> or <a class="el" href="../../d1/d12/group___g_p_uutil.html#gacaa947ae99123030938976a2f91dc111" title="free data of GPU">device_free()</a>.</p>
<p>Most of the functions are executed on either CPU or GPU according to get_device_mem_stat() . A copy constructor is special, it is a function that copies an instance of a class. So both CPU and GPU data will be copied.</p>
<p>For developers, there is a nonfree_recv() function that receives data from the GPU without freeing the GPU memory. However, in the current version, there is no way to explicitly change the status of GPU memory, so it is not useful for most users.</p>
<p>GPU programs using monolish are implemented with the following flow in mind.</p><ol type="1">
<li>First, generates data on CPU, and then</li>
<li>Transfer data from CPU to GPU</li>
<li>Calculate on GPU,</li>
<li>Finally, receive data from GPU to CPU</li>
</ol>
<p>It is important to be aware that <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">send()</a> and <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9" title="recv. and free data from GPU">recv()</a> should not be performed many times in order to reduce transfers.</p>
<h1><a class="anchor" id="autotoc_md107"></a>
Compute innerproduct on GPU</h1>
<p>A simple inner product program for GPU is shown below:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d6/da1/monolish__blas_8hpp.html">monolish_blas.hpp</a>&gt;</span></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Output log if you need</span></div>
<div class="line">  <span class="comment">// monolish::util::set_log_level(3);</span></div>
<div class="line">  <span class="comment">// monolish::util::set_log_filename(&quot;./monolish_test_log.txt&quot;);</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">size_t</span> N = 100;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// x = {1,1,...,1}, length N</span></div>
<div class="line">  <a class="code" href="../../d7/d15/classmonolish_1_1vector.html">monolish::vector&lt;double&gt;</a> x(N, 1.0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Random vector length N with random values in the range 1.0 to 2.0</span></div>
<div class="line">  <span class="comment">// Random seed is 123 (mt19937)</span></div>
<div class="line">  <a class="code" href="../../d7/d15/classmonolish_1_1vector.html">monolish::vector&lt;double&gt;</a> y(N, 1.0, 2.0, 123);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// send data to GPU</span></div>
<div class="line">  <a class="code" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40">monolish::util::send</a>(x, y);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// compute innerproduct</span></div>
<div class="line">  <span class="keywordtype">double</span> ans = <a class="code" href="../../d1/dcc/group__dot.html#gae2d0ccb507b36f6ee1bea2e0345dacfc">monolish::blas::dot</a>(x, y);</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; ans &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassmonolish_1_1vector_html"><div class="ttname"><a href="../../d7/d15/classmonolish_1_1vector.html">monolish::vector&lt; double &gt;</a></div></div>
<div class="ttc" id="agroup___g_p_uutil_html_ga7d9350df95acfad598d1d11dae55db40"><div class="ttname"><a href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40">monolish::util::send</a></div><div class="ttdeci">void send(T &amp;x)</div><div class="ttdoc">send data to GPU</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d57/monolish__common_8hpp_source.html#l00729">monolish_common.hpp:729</a></div></div>
<div class="ttc" id="agroup__dot_html_gae2d0ccb507b36f6ee1bea2e0345dacfc"><div class="ttname"><a href="../../d1/dcc/group__dot.html#gae2d0ccb507b36f6ee1bea2e0345dacfc">monolish::blas::dot</a></div><div class="ttdeci">void dot(const vector&lt; double &gt; &amp;x, const vector&lt; double &gt; &amp;y, double &amp;ans)</div><div class="ttdoc">inner product (dot)</div></div>
<div class="ttc" id="amonolish__blas_8hpp_html"><div class="ttname"><a href="../../d6/da1/monolish__blas_8hpp.html">monolish_blas.hpp</a></div></div>
</div><!-- fragment --><p>This sample code can be found in <code>/sample/blas/innerproduct/</code>.</p>
<p>This program can be compiled by the following command. </p><div class="fragment"><div class="line">g++ -O3 innerproduct.cpp -o innerproduct_cpu.out -lmonolish_gpu</div>
</div><!-- fragment --><p>The following command runs this. </p><div class="fragment"><div class="line">./innerproduct_gpu.out</div>
</div><!-- fragment --><p>A description of this program is given below:</p><ul>
<li>Each class has <code><a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">send()</a></code> and <code><a class="el" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9" title="recv. and free data from GPU">recv()</a></code> functions.</li>
<li><a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">monolish::util::send()</a> is a convenient util function that can take variable length arguments.</li>
<li>The scalar values are automatically synchronized between the CPU and GPU.</li>
<li>The BLAS and VML functions in monolish automatically call the GPU functions when they receive data that has already been sent.</li>
<li>When libmonolish_cpu.so is linked, <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">send()</a> and <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9" title="recv. and free data from GPU">recv()</a> do nothing, the CPU and GPU code can be shared.</li>
<li>In this program, <code>x</code> and <code>y</code> do not need to be received to CPU, so the memory management was left to the automatic release by the destructor.</li>
</ul>
<p>For a more advanced example, sample programs that implement CG methods using monolish::BLAS and monolish::VML can be found in <code>/sample/blas/cg_impl/</code>.</p>
<h1><a class="anchor" id="autotoc_md108"></a>
Solve Ax=b on GPU</h1>
<p>The following is a sample program that solves a linear equations; Ax=b using the conjugate gradient method with jacobi preconditioner on GPU.</p>
<p>This program requires only two lines of changes from the CPU program.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d4/d65/monolish__equation_8hpp.html">monolish_equation.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Output log if you need</span></div>
<div class="line">  <span class="comment">// monolish::util::set_log_level(3);</span></div>
<div class="line">  <span class="comment">// monolish::util::set_log_filename(&quot;./monolish_test_log.txt&quot;);</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="../../d0/d7e/classmonolish_1_1matrix_1_1_c_o_o.html">monolish::matrix::COO&lt;double&gt;</a> A_COO(<span class="stringliteral">&quot;sample.mtx&quot;</span>); <span class="comment">// Input from file</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Edit the matrix as needed //</span></div>
<div class="line">  <span class="comment">// Execute A_COO.sort() after editing the matrix //</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create CRS format matrix and convert from COO format matrix</span></div>
<div class="line">  <a class="code" href="../../db/da5/classmonolish_1_1matrix_1_1_c_r_s.html">monolish::matrix::CRS&lt;double&gt;</a> A(A_COO);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Length A.row()</span></div>
<div class="line">  <span class="comment">// Random vector length A.row() with random values in the range 1.0 to 2.0</span></div>
<div class="line">  <span class="comment">// Random seeds are 123 and 321 (mt19937)</span></div>
<div class="line">  <a class="code" href="../../d7/d15/classmonolish_1_1vector.html">monolish::vector&lt;double&gt;</a> x(A.get_row(), 1.0, 2.0, 123);</div>
<div class="line">  <a class="code" href="../../d7/d15/classmonolish_1_1vector.html">monolish::vector&lt;double&gt;</a> b(A.get_row(), 1.0, 2.0, 321);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40">monolish::util::send</a>(A, x, b);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create CG class</span></div>
<div class="line">  <a class="code" href="../../d0/dec/classmonolish_1_1equation_1_1_c_g.html">monolish::equation::CG&lt;monolish::matrix::CRS&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; solver;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// create jacobi preconditioner</span></div>
<div class="line">  <a class="code" href="../../df/d69/classmonolish_1_1equation_1_1_jacobi.html">monolish::equation::Jacobi&lt;monolish::matrix::CRS&lt;double&gt;</a>, <span class="keywordtype">double</span>&gt; precond;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set preconditioner to CG solver</span></div>
<div class="line">  solver.<a class="code" href="../../db/dac/classmonolish_1_1solver_1_1solver.html#adee3a5397949638fe40dbd8739c032fd">set_create_precond</a>(precond);</div>
<div class="line">  solver.<a class="code" href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a2b909470e2632f30347a1e9c92ed4e99">set_apply_precond</a>(precond);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set solver options</span></div>
<div class="line">  solver.<a class="code" href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a1c7e0d5cad23dc1e74db3f55e0aa554d">set_tol</a>(1.0e-12);</div>
<div class="line">  solver.<a class="code" href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a7d7786e1a01ad8d5992e7a41a6ba6039">set_maxiter</a>(A.get_row());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// if you need residual history</span></div>
<div class="line">  <span class="comment">// solver.set_print_rhistory(true);</span></div>
<div class="line">  <span class="comment">// solver.set_rhistory_filename(&quot;./a.txt&quot;);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Solve Ax=b by CG with jacobi</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="../../db/d72/group__errcheck.html#ga376a2e6e7a83cf532104994aaacfd17e">monolish::util::solver_check</a>(solver.<a class="code" href="../../d0/dec/classmonolish_1_1equation_1_1_c_g.html#a7a30a93f085e4c0c430a2386d54d513e">solve</a>(A, x, b))) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Recv x from GPU</span></div>
<div class="line">  <a class="code" href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9">monolish::util::recv</a>(x);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Show answer</span></div>
<div class="line">  x.print_all();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassmonolish_1_1equation_1_1_c_g_html"><div class="ttname"><a href="../../d0/dec/classmonolish_1_1equation_1_1_c_g.html">monolish::equation::CG</a></div><div class="ttdoc">CG solver class.</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/monolish__equation_8hpp_source.html#l00088">monolish_equation.hpp:88</a></div></div>
<div class="ttc" id="aclassmonolish_1_1equation_1_1_c_g_html_a7a30a93f085e4c0c430a2386d54d513e"><div class="ttname"><a href="../../d0/dec/classmonolish_1_1equation_1_1_c_g.html#a7a30a93f085e4c0c430a2386d54d513e">monolish::equation::CG::solve</a></div><div class="ttdeci">int solve(MATRIX &amp;A, vector&lt; Float &gt; &amp;x, vector&lt; Float &gt; &amp;b)</div><div class="ttdoc">solve Ax = b by BiCGSTAB method(lib=0: monolish)</div></div>
<div class="ttc" id="aclassmonolish_1_1equation_1_1_jacobi_html"><div class="ttname"><a href="../../df/d69/classmonolish_1_1equation_1_1_jacobi.html">monolish::equation::Jacobi</a></div><div class="ttdoc">Jacobi solver class.</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d65/monolish__equation_8hpp_source.html#l00220">monolish_equation.hpp:220</a></div></div>
<div class="ttc" id="aclassmonolish_1_1matrix_1_1_c_o_o_html"><div class="ttname"><a href="../../d0/d7e/classmonolish_1_1matrix_1_1_c_o_o.html">monolish::matrix::COO</a></div><div class="ttdoc">Coodinate (COO) format Matrix (need to sort)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de7/monolish__coo_8hpp_source.html#l00043">monolish_coo.hpp:43</a></div></div>
<div class="ttc" id="aclassmonolish_1_1matrix_1_1_c_r_s_html"><div class="ttname"><a href="../../db/da5/classmonolish_1_1matrix_1_1_c_r_s.html">monolish::matrix::CRS</a></div><div class="ttdoc">Compressed Row Storage (CRS) format Matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d00/monolish__crs_8hpp_source.html#l00034">monolish_crs.hpp:34</a></div></div>
<div class="ttc" id="aclassmonolish_1_1solver_1_1solver_html_a1c7e0d5cad23dc1e74db3f55e0aa554d"><div class="ttname"><a href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a1c7e0d5cad23dc1e74db3f55e0aa554d">monolish::solver::solver::set_tol</a></div><div class="ttdeci">void set_tol(double t)</div><div class="ttdoc">set tolerance (default:1.0e-8)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0e/monolish__solver_8hpp_source.html#l00092">monolish_solver.hpp:92</a></div></div>
<div class="ttc" id="aclassmonolish_1_1solver_1_1solver_html_a2b909470e2632f30347a1e9c92ed4e99"><div class="ttname"><a href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a2b909470e2632f30347a1e9c92ed4e99">monolish::solver::solver::set_apply_precond</a></div><div class="ttdeci">void set_apply_precond(PRECOND &amp;p)</div><div class="ttdoc">set precondition apply function</div></div>
<div class="ttc" id="aclassmonolish_1_1solver_1_1solver_html_a7d7786e1a01ad8d5992e7a41a6ba6039"><div class="ttname"><a href="../../db/dac/classmonolish_1_1solver_1_1solver.html#a7d7786e1a01ad8d5992e7a41a6ba6039">monolish::solver::solver::set_maxiter</a></div><div class="ttdeci">void set_maxiter(size_t max)</div><div class="ttdoc">set max iter. (default = SIZE_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0e/monolish__solver_8hpp_source.html#l00098">monolish_solver.hpp:98</a></div></div>
<div class="ttc" id="aclassmonolish_1_1solver_1_1solver_html_adee3a5397949638fe40dbd8739c032fd"><div class="ttname"><a href="../../db/dac/classmonolish_1_1solver_1_1solver.html#adee3a5397949638fe40dbd8739c032fd">monolish::solver::solver::set_create_precond</a></div><div class="ttdeci">void set_create_precond(PRECOND &amp;p)</div><div class="ttdoc">set precondition create function</div></div>
<div class="ttc" id="agroup___g_p_uutil_html_ga8f7678dbc48ee4fbf6c86594220882d9"><div class="ttname"><a href="../../d1/d12/group___g_p_uutil.html#ga8f7678dbc48ee4fbf6c86594220882d9">monolish::util::recv</a></div><div class="ttdeci">void recv(T &amp;x)</div><div class="ttdoc">recv. and free data from GPU</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d57/monolish__common_8hpp_source.html#l00745">monolish_common.hpp:745</a></div></div>
<div class="ttc" id="agroup__errcheck_html_ga376a2e6e7a83cf532104994aaacfd17e"><div class="ttname"><a href="../../db/d72/group__errcheck.html#ga376a2e6e7a83cf532104994aaacfd17e">monolish::util::solver_check</a></div><div class="ttdeci">bool solver_check(const int err)</div><div class="ttdoc">check error</div></div>
<div class="ttc" id="amonolish__equation_8hpp_html"><div class="ttname"><a href="../../d4/d65/monolish__equation_8hpp.html">monolish_equation.hpp</a></div></div>
</div><!-- fragment --><p>This sample code can be found in <code>/sample/equation/cg/</code>.</p>
<ul>
<li>After creating the vectors and matrix A, send the data to the GPU using the <a class="el" href="../../d1/d12/group___g_p_uutil.html#ga7d9350df95acfad598d1d11dae55db40" title="send data to GPU">monolish::util::send()</a> function.</li>
<li>For x that requires output, explicitly receive data to the CPU using the <a class="el" href="../../d7/d15/classmonolish_1_1vector.html#a3c099868f9b37f98d7433aa2d34f140b">recv()</a> function. At this time, the memory of x on the GPU is released.</li>
<li>The CPU/GPU memory of A, A_COO, and b is released by the destructor at the end of the function.</li>
</ul>
<p>A sample program for a templated linear equation solver can be found at <code>sample/equation/templated_solver</code>.</p>
<h1><a class="anchor" id="autotoc_md109"></a>
Environment variable</h1>
<ul>
<li>LIBOMPTARGET_DEBUG= [1 or 0] : Output debug information on OpenMP Offloading at runtime</li>
<li>CUDA_VISIBLE_DEVICES= [Device num.] : Specify GPU device number </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
